- 实现简单的数据访问接口

![BD5193013ED21543A9735CF078186309](images/BD5193013ED21543A9735CF078186309.png)

起一个高大上的名字就叫数据服务总线

过程
===

- 接受客户端的请求报文

- 解析URL中的参数，参数中指定了查询数据的条件

  权限控制：用户名和密码

  接口名：访问数据的种类

  查询条件：设计接口的时候决定

  ![944A27A78C394D1A62DF8FFB4E224205](images/944A27A78C394D1A62DF8FFB4E224205.png)

  通过下面那一行给每个参数起个名字，使可读性比较好，参数的顺序谁在前，谁在后都没有关系，如果某个参数有缺省值可以不填

  ## 1、写解析URL的函数

  第一个参数：请求报文的内容

  第二个参数：参数名

  第三个参数：用于存放参数的值

  第四个参数：参数值的最大长度

  先找到参数名的位置，再找到参数值结束的位置(要么是&，要么是空格)，因为URL不会有空格

  ![CD01D4103816BFC61952E92A94512648](images/CD01D4103816BFC61952E92A94512648.png)

- 从T_ZHOBTMIND表中查询数据，以xml格式返回给客户端

解析GET请求中的参数，从T_ZHOBTMIND表中查询数据，返回给客户端

2、声明几个变量用于存放参数的值，从请求报告中解析参数
---

![DBD4D70B08740C6593FA4CF268933F3F](images/DBD4D70B08740C6593FA4CF268933F3F.png)

3、把参数的值显示出来
---

![F45776F614FC62A72D9DEE20E1029FAF](images/F45776F614FC62A72D9DEE20E1029FAF.png)

4、解析完参数，应该判断用户名/密码和接口名是否合法
---

5、连接数据库
---

![94F3B0FE6BD9AD112ABB90D7B6D3DA38](images/94F3B0FE6BD9AD112ABB90D7B6D3DA38.png)

获取结果集，返回给客户端![652A656ED35DE4524FAA843E65F2DF36](images/652A656ED35DE4524FAA843E65F2DF36.png)

6 
---

先运行服务端

![255DC0A829FEA06A3CFF32F910E11F43](images/255DC0A829FEA06A3CFF32F910E11F43.png)

再运行客户端

在这个站点和时间段在表中一定要有数据，得到数据文件 data.csv

![EE248C8BD48D555E968E5BA561D9D21B](images/EE248C8BD48D555E968E5BA561D9D21B.png)